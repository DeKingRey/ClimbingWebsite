{% extends 'layout.html' %}
{% block content %}
    <h1>{{info[0][0]}}</h1> <!-- This is the locations name -->

    <div class="divider"></div>

    <div class="location-section">
        <div class="image-container">
            <img src="{{ info[0][2] }}" alt="location-image" class="location-image"> <br> <!-- This is the locations image-->
        </div>
        
        <div class="routes-container">
            {% if info[1] %}
                <h2>Routes</h2>
                <div class="routes-list">
                    {% for route in info[1] %}
                        <a class="route-link" href="/map/{{info[0][1]}}/{{info[1][route][1]}}?id={{route}}">
                            {{info[1][route][0]}}
                        </a>
                    {% endfor %} <!-- Goes through all the given routes in the dictionary, and sets the link to map/location-name/route-name?route_id, then the display of the link is the routes name. -->
                </div>
            {% else %}
                <h2>No current routes.</h2>
            {% endif %}
        </div>
    </div>
    
    {% if username %}
        <button data-popup-target="route-popup" class="button">Add Route</button> <!-- This button has a custom data field which is used by JS to know what popup it is trying to access-->
    {% else %}
        <button class="button" onclick="location.href='/login'">Log in to Add a Route</button> <!-- Redirects to the login page if they are not logged in -->
    {% endif %}

    <div class="popup" id="route-popup"> <!-- Popup Div-->
        <div class="popup-inner"> <!-- Popup Content -->
            <button data-popup-close class="close-button">&times;</button>
            <h2>Add Route</h2>
            <form action="{{ url_for('add_route') }}" method="POST"> <!-- This is the form to add a route, with the route name, grade, amount of bolts, location, and types. -->
                
                <div class="form-group">
                    <label for="name">Route Name</label>
                    <input type="text" id="name" name="name" required> 
                </div>

                <div class="form-group">
                    <label for="grade">Grade</label>
                    <input type="text" id="grade" name="grade" required> 
                </div>

                <div class="form-group">
                    <label for="bolts">Amount of Bolts</label>
                    <input type="text" name="bolts" id="bolts"> 
                </div>

                <input type="hidden" name="location" id="location" value="{{info[0][0]}}"> <!-- Uses the current location instead of a manual input-->

                <input type="hidden" name="url" id="url" value="{{ request.full_path }}"> <!-- Gets the current url route-->

                <div class="form-group">
                    <label for="types">Types</label>
                    <div class="dropdown">
                        <button type="button" class="button">Select Types</button>
                        <div class="dropdown-content">
                            {% for type in types %}
                                <label><input type="checkbox" name="types[]" value="{{type[0]}}">{{type[1]}}</label>
                            {% endfor %}
                        </div> <!-- Types goes through all given types and adds them to the multiselect dropdown. -->
                    </div>
                </div>

                <div class="form-group">
                    <button type="submit" class="button submit-button">Submit</button>
                </div>
            </form>
        </div> 
    </div><br><br>

    <script src="/static/js/popup.js"></script>

{% endblock %}